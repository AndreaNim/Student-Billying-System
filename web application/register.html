<!DOCTYPE html>
<html lang="en">
<head>
  <title>Billying System</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>

<div class="container">
  <h2>Registration form</h2>
  <form action="/action_page.php" id="registerform">
    <div class="form-group">
        <label for="firstName">First Name:</label>
        <input type="firstName" class="form-control" id="firstName" placeholder="Enter First Name" name="firstName">
    </div>
    <div class="form-group">
        <label for="lastName">Last Name:</label>
        <input type="lastName" class="form-control" id="lastName" placeholder="Enter Last Name" name="lastName">
    </div>
    <div class="form-group">
        <label for="student_tele_number">Telephone number:</label>
        <input type="student_tele_number" class="form-control" id="student_tele_number" placeholder="Enter student_tele_number" name="student_tele_number">
    </div>
    <div class="form-group">
      <label for="email">Email:</label>
      <input type="email" class="form-control" id="email"  name="email">
    </div>
    <div class="form-group">
      <label for="pwd">Password:</label>
      <input type="password" class="form-control" id="pwd" placeholder="Enter password" name="pwd">
    </div>
    <div class="form-group">
        <label for="gender">Gender:</label>
        <div >
          <select name="gender" id="gender">
            <option value="F" id="F">Female</option>
            <option value="M" id="M">Male</option>
          </select>
            
          </div>
    </div>
    <button type="submit" class="btn btn-default">Submit</button>
    <div class="form-group">
      <br>
      <h3 id="message"></h3>
    </div>
  </form>
</div>


<script>
    const registerform=document.getElementById("registerform");
    registerform.addEventListener("submit",(event)=>{
        event.preventDefault();
        const firstName=document.getElementById("firstName").value;
        const lastName=document.getElementById("lastName").value;
        const student_tele_number=document.getElementById("student_tele_number").value;
        const email = document.getElementById("email").value;
        const password = document.getElementById("pwd").value;
        const gender=document.getElementById("gender").value;
       
        fetch("http://localhost:8080/students/register",{
        method:"POST",
        headers:{
           'Content-Type': 'application/json'
        },
        body:JSON.stringify({ 
          "firstName":firstName, 
          "lastName":lastName, 
          "student_tele_number":student_tele_number, 
          "email":email,
          "password": password,
          "gender":gender,
          "date_of_birth":"2012-12-01"
        })
        }).then(res => {
          console.log(res)
          if(!res.ok){
            return Promise.reject(res.json())
          }
            return res.json();
        })
        .then (data => {
           document.getElementById("message").innerHTML = 'success';
           window.location.replace("login.html")
          }).catch((error)=>{
            if(error.message){
              document.getElementById("message").innerHTML = error.message;
            }else{
              error.then(resp =>{
              console.log("error")
              console.log(resp.message)
              document.getElementById("message").innerHTML = resp.message;
            })
            }

          })
    });
    
    
</script>
</body>
</html>

